# README

## Описание проекта

Данный проект представляет собой API для работы с Excel-файлами и данными. Он предоставляет функционал загрузки Excel-файлов, обработки данных и получения записей, сгруппированных по дате. Проект выполнен в соответствии с тестовым заданием.

---

## Функциональные требования

### Выполненные задачи:

#### Загрузка Excel-файлов:
- Реализована форма для загрузки Excel-файлов.
- Файлы валидируются на соответствие формату `.xlsx`.
- После успешной загрузки данные из файла обрабатываются и сохраняются в базу данных.

#### Хранение данных:
Для хранения данных используется таблица `rows` с полями:
- `excel_id`: ID записи из Excel (уникальный).
- `name`: Имя.
- `date`: Дата записи.

#### Получение данных:
- Данные можно получить в формате JSON, сгруппированными по дате.

#### Документация API:
- В проекте настроен Swagger UI для документирования и тестирования API.

---

## Структура проекта

- **`app/Http/Controllers`**:
    - `ExcelImportController`: Управляет загрузкой Excel-файлов.
    - `RowsController`: Обрабатывает запросы на получение данных.

- **`app/Http/Middleware`**:
    - `BasicAuthMiddleware`: Реализует базовую аутентификацию.

- **`app/Models`**:
    - `Row`: Модель для работы с таблицей `rows`.

- **`database/migrations`**:
    - Миграции для создания таблицы `rows`.

- **`tests/Feature`**:
    - Тесты для проверки работы контроллеров.

- **`tests/Unit`**:
    - Тесты для проверки валидации и обработки данных.

---

## Инструкция по разворачиванию

### 1. Клонирование репозитория
```bash
git clone https://github.com/dushesss45/excel-import.git
cd excel-import
```

### 2. Запуск проекта с использованием Docker
1. Убедитесь, что у вас установлен Docker и Docker Compose.
2. Выполните команду:
   ```bash
   docker-compose up -d
   ```
   Это запустит контейнеры для приложения, базы данных и веб-сервера.

### 3. Запуск миграций
Выполните миграции для создания таблицы `rows` внутри контейнера:
```bash
docker exec -it excel-import-app php artisan migrate
```

---

## Использование

### Доступ к приложению
После запуска контейнеров приложение будет доступно по адресу: [http://localhost:8000](http://localhost:8000).

### Swagger UI
Swagger UI доступен по адресу: [http://localhost:8000/swagger/index.html](http://localhost:8000/swagger/index.html).

---

## Примеры API-запросов

### Загрузка формы для Excel
**GET `/upload-form`**
- **Описание**: Возвращает HTML-форму для загрузки Excel-файла.
- **Требуется аутентификация**: Да (Basic Auth).

### Загрузка Excel-файла
**POST `/upload-excel`**
- **Описание**: Загружает Excel-файл и отправляет его на обработку.
- **Требуется аутентификация**: Да (Basic Auth).
- **Пример тела запроса**:
  ```http
  Content-Type: multipart/form-data
  file: <файл>
  ```

### Получение данных
**GET `/rows`**
- **Описание**: Возвращает записи, сгруппированные по дате.

---

## Запуск тестов
Для проверки функционала выполните:
```bash
docker exec -it excel-import-app php artisan test
```

---

## Основные технологии
- Laravel 10.x
- Swagger UI
- PHPUnit
- Docker & Docker Compose

---

## Дополнительная информация
Проект защищен Basic Auth. Для выполнения запросов необходимо указать логин и пароль, заданные в `.env`:
```env
BASIC_AUTH_USER=admin
BASIC_AUTH_PASS=pass
```